<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>CodeArcs.de | Demo App</title>
    <link rel="stylesheet" href="./css/editor.main.css">
</head>
<body>
    <main>
        <div class="left-pane">
            <ul class="service-list">
                <li class="service-list-item" style="text-align: center;">
                    <a href="#">Add Service</a>
                </li>
            </ul>
        </div>
        <div class="main-pane">
            <pre id="output"></pre>
        </div>
    </main>
    <script>
        const {ipcRenderer} = require('electron');
        const fs = require('fs');
        const YAML = require('yamljs');

        ipcRenderer.on('open-file', (event, arg) => {
            if(arg && arg[0]) {
                const content = fs.readFileSync(arg[0], 'utf8');
                const activeServices = YAML.parse(content);

                let commentedOutLines = content.match(/^\s*#.*/mg);
                commentedOutLines = (commentedOutLines || []).join('\n').replace(/^(\s*)#/mg, '$1');
                const inActiveServices = YAML.parse(commentedOutLines);
                renderServiceList(Object.keys(activeServices));
                renderServiceList(Object.keys(inActiveServices), false);
            }
        });

        function renderServiceList(services, active = true) {
            services.map(service => {
                const li = document.createElement('li');
                li.className = "service-list-item";

                const a = document.createElement('a');
                a.href = "#";
                a.innerText = service;

                const input = document.createElement('input');
                input.type = 'checkbox';
                input.checked = active;

                li.appendChild(a);
                //li.appendChild(input);
                document.getElementsByClassName('service-list')[0].appendChild(li);
            });
        }
    </script>
</body>
</html>